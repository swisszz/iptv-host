<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>IPTV Thai Digital</title>
  <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
  <style>
    body { background: #000; color: #fff; font-family: sans-serif; margin: 0; padding: 0; }
    .list { display: flex; flex-wrap: wrap; gap: 10px; padding: 10px; justify-content: center; }
    .button { background: #222; padding: 10px; width: 140px; text-align: center; border-radius: 8px; cursor: pointer; box-shadow: 0 0 5px #333; }
    .button:hover { background: #333; }
    .button img { width: 100%; border-radius: 6px; }
    #player-container { display: flex; justify-content: center; padding: 10px; }
    video { width: 100%; max-width: 800px; height: 450px; border: none; background: #000; }
    #login-box { position: fixed; inset: 0; background: #000; display: flex; justify-content: center; align-items: center; z-index: 9999; }
    #login-box input { padding: 10px; font-size: 18px; width: 200px; text-align: center; }
    #login-box button { padding: 10px 20px; margin-left: 10px; }
  </style>
</head>
<body>

  <!-- ðŸ” à¸à¸¥à¹ˆà¸­à¸‡à¸¥à¹‡à¸­à¸à¸­à¸´à¸™ -->
  <div id="login-box">
    <input type="password" id="password" placeholder="à¸à¸£à¸­à¸à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™" />
    <button onclick="checkPassword()">à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸š</button>
  </div>

  <div id="player-container" style="display: none;">
    <video id="video" controls autoplay playsinline></video>
  </div>

  <div id="channels" class="list" style="display: none;"></div>

  <script>
    const kauthToken = 'à¹ƒà¸ªà¹ˆ-kauth-token-à¸‚à¸­à¸‡à¸„à¸¸à¸“-here';
    const secretPassword = '7474'; // 
    function checkPassword() {
      const input = document.getElementById('password').value;
      if (input === secretPassword) {
        document.getElementById('login-box').style.display = 'none';
        document.getElementById('channels').style.display = 'flex';
        document.getElementById('player-container').style.display = 'flex';
        initUI();
      } else {
        alert('à¸£à¸«à¸±à¸ªà¸œà¹ˆà¸²à¸™à¹„à¸¡à¹ˆà¸–à¸¹à¸à¸•à¹‰à¸­à¸‡ âŒ');
      }
    }

    const channelNames = [
      'CH3 HD', 'CH3 HD Backup',
      'CH5 HD', 'CH5 HD Backup',
      'CH7 HD', 'CH7 HD Backup',
      'CH9 HD', 'CH9 HD Backup',
      'WorkPoint HD', 'WorkPoint HD Backup',
      'GMM HD', 'GMM HD Backup',
      'Mono HD', 'Mono HD Backup',
      'CH8 HD', 'CH8 HD Backup',
      'ONE HD', 'ONE HD Backup',
      'Amarin HD','Amarin HD Backup',
      'Thairath TV HD','Thairath TV HD Backup',
      'PPTV HD','PPTV HD Backup',
      'Nation TV HD','Nation TV HD Backup',
      'JKN TV HD','JKN TV HD Backup',
      'TNN TV HD','TNN TV HD Backup',
      'Thai PBS TV HD','Thai PBS TV HD Backup',
      'NBT TV HD','NBT TV HD Backup'
    ];

    const channelCodes = [
      'hd-ch3','hd-ch3bkp','hd-ch5','hd-ch5bkp','hd-ch7','hd-ch7bkp',
      'hd-ch9','hd-ch9bkp','hd-workpoint','hd-workpointbkp','sd-gmmchannel','sd-gmmchannelbkp',
      'hd-mono','hd-monobkp','hd-ch8','hd-ch8bkp','hd-gmmone','hd-gmmonebkp',
      'hd-amarin','hd-amarinbkp','hd-thairath','hd-thairathbkp','hd-pptv','hd-pptvbkp',
      'sd-nation','sd-nationbkp','hd-jkn','hd-jknbkp','sd-tnn24','sd-tnn24bkp',
      'hd-tpbs','th-tpbs','sd-nbt','sd-nbtbkp'
    ];

    const channelLogos = channelCodes.map(code => `https://static.uflixtv.com/images/tv/channels_icons/${code}.png`);

    const video = document.getElementById('video');
    const channelsDiv = document.getElementById('channels');

    async function login() {
      const resp = await fetch(`https://cloud.ufxtv.com/api/user/login/?user_email=BE0134&user_password=1111&kauth=${kauthToken}`);
      const txt = await resp.text();
      const m = txt.match(/<user_loggedsession>(.*?)<\/user_loggedsession>/);
      return m ? m[1] : null;
    }

    async function getClearUrl(session, code) {
      const resp = await fetch(`https://cloud.ufxtv.com/api/tv/channels/play/?c=${code}&kauth=${kauthToken}&user_loggedsession=${session}`);
      let txt = await resp.text();
      if (txt.includes('session failed')) {
        session = await login();
        const next = await fetch(`https://cloud.ufxtv.com/api/tv/channels/play/?c=${code}&kauth=${kauthToken}&user_loggedsession=${session}`);
        txt = await next.text();
      }
      const m = txt.match(/<clear_url>(.*?)<\/clear_url>/);
      return m ? m[1] : null;
    }

    async function playChannel(index) {
      const session = await login();
      const streamUrl = await getClearUrl(session, channelCodes[index]);
      if (streamUrl) {
        if (Hls.isSupported()) {
          const hls = new Hls();
          hls.loadSource(streamUrl);
          hls.attachMedia(video);
        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
          video.src = streamUrl;
        }
        video.play();
      } else alert('à¹„à¸¡à¹ˆà¸ªà¸²à¸¡à¸²à¸£à¸–à¹€à¸¥à¹ˆà¸™à¸Šà¹ˆà¸­à¸‡à¹„à¸”à¹‰');
    }

    function initUI() {
      channelsDiv.innerHTML = '';
      channelCodes.forEach((code, idx) => {
        const btn = document.createElement('div');
        btn.className = 'button';
        btn.innerHTML = `<img src="${channelLogos[idx]}" alt=""><div>${channelNames[idx]}</div>`;
        btn.onclick = () => playChannel(idx);
        channelsDiv.appendChild(btn);
      });
    }
  </script>

</body>
</html>
